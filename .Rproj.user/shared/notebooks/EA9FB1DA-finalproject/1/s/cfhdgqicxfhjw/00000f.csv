"0","# Load the library for Ridge and Lasso"
"0","library(glmnet)"
"0",""
"0","# Prepare matrix for glmnet"
"0","x <- model.matrix(charges ~ age + bmi + children + smoker + sex + region +  sex:smoker + smoker:region, data = training_data)[,-1]"
"0","y <- training_data$charges"
"0",""
"0","# Fit Ridge Regression Model"
"0","ridge_model <- glmnet(x, y, alpha = 0)"
"0","lasso_model <- glmnet(x, y, alpha = 1)"
"0",""
"0","# Making predictions on the testing set"
"0","ridge_predictions <- predict(ridge_model, s = 0.01, newx = model.matrix(~ age + bmi + children + smoker + sex + region +  sex:smoker + smoker:region, data = testing_data)[,-1])"
"0","lasso_predictions <- predict(lasso_model, s = 0.01, newx = model.matrix(~ age + bmi + children + smoker + sex + region +  sex:smoker + smoker:region, data = testing_data)[,-1])"
"0",""
"0","# Comparing models"
"0","compare_results <- data.frame("
"0","  Actual = testing_data$charges,"
"0","  Linear = predictions,"
"0","  Ridge = as.vector(ridge_predictions),"
"0","  Lasso = as.vector(lasso_predictions)"
"0",")"
"0","head(compare_results)"
